<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<style type="text/css">
		@import url('../css/main.css');
	</style>

	<title>Installing libreboot</title>
</head>

<body>

	<div class="section">
		
		<h1 id="pagetop">Installing libreboot</h1>
			<p>
				This section relates to installing libreboot on supported targets.
			</p>
			<p>
				<a href="../index.html">Back to previous index</a>
			</p>
			
	</div>
			
	<div class="section">

			<ul>
				
			</ul>
			
		<h2>Software methods</h2>
			<ul>
				<li><a href="#rom">List of ROM images in libreboot</a></li>
				<li><a href="#flashrom">How to install or update libreboot (if running libreboot or coreboot)</a></li>
				<li><a href="#flashrom_lenovobios">ThinkPad X60/T60: Initial installation guide (if running Lenovo BIOS firmware)</a></li>
				<li><a href="#flashrom_macbook21">MacBook2,1: Initial installation guide (if running Apple EFI firmware)</a></li>
			</ul>

		<h2>Hardware methods</h2>
			<ul>
				<li><a href="bbb_setup.html">How to programme an SPI flash chip with the BeagleBone Black</a></li>
				<li><a href="x60_unbrick.html">ThinkPad X60: Recovery guide</a></li>
				<li><a href="x60tablet_unbrick.html">ThinkPad X60 Tablet: Recovery guide</a></li>
				<li><a href="t60_unbrick.html">ThinkPad T60: Recovery guide</a></li>
				<li><a href="x200_external.html">ThinkPad X200: Initial installation guide</a> (also the recovery guide)</li>
				<li><a href="r400_external.html">ThinkPad R400: Initial installation guide</a> (also the recovery guide)</li>
				<li><a href="t400_external.html">ThinkPad T400: Initial installation guide</a> (also the recovery guide)</li>
				<li><a href="t500_external.html">ThinkPad T500: Initial installation guide</a> (also the recovery guide)</li>
			</ul>
			
	</div>

	<div class="section">

		<h1 id="rom">List of ROM images in libreboot</h1>

			<p>
				Libreboot supports the following (refer to the <a href="../release.html">release</a> page):
			</p>
				<ul>
					<li>Apple MacBook1,1 and MacBook2,1: download <b>libreboot_macbook21.tar.xz</b></li>
					<li>ThinkPad X60, X60s and X60 Tablet: download <b>libreboot_x60.tar.xz</b></li>
					<li>ThinkPad T60: download <b>libreboot_t60.tar.xz</b> (see <a href="../hcl/index.html#supported_t60_list">../hcl/index.html#supported_t60_list</a>)</li>
					<li>ThinkPad X200: download <b>libreboot_x200_8mb.tar.xz</b> (8MiB flash chip) or <b>libreboot_x200_4mb.tar.xz</b> (4MiB flash chip) (see <a href="../hcl/x200.html">../hcl/x200.html</a>)</li>
					<li>ThinkPad R400: download <b>libreboot_r400_8mb.tar.xz</b> (8MiB flash chip) or <b>libreboot_r400_4mb.tar.xz</b> (4MiB flash chip) (see <a href="../hcl/r400.html">../hcl/r400.html</a>)</li>
					<li>ThinkPad T400: download <b>libreboot_t400_8mb.tar.xz</b> (8MiB flash chip) or <b>libreboot_t400_4mb.tar.xz</b> (4MiB flash chip) (see <a href="../hcl/t400.html">../hcl/t400.html</a>)</li>
					<li>ThinkPad T500: download <b>libreboot_t500_8mb.tar.xz</b> (8MiB flash chip) or <b>libreboot_t500_4mb.tar.xz</b> (4MiB flash chip) (see <a href="../hcl/t500.html">../hcl/t500.html</a>)</li>
				</ul>
				
			<p>
				The ROM images in each archive use the following naming convention: <b>boardname_keymap_mode.rom</b>
			</p>
			<p>
				Available <i>modes</i>: <b>vesafb</b> or <b>txtmode</b>. The <i>vesafb</i> ROM images are recommended, in most cases;
				<i>txtmode</i> ROM images come with MemTest86+, which requires text-mode instead of the usual framebuffer used
				by coreboot native graphics initialization.
			</p>
			<p>
				Keymaps are named appropriate according to each keyboard layout
				support in GRUB. To learn how these keymaps are created, see
				<a href="../grub/index.html#grub_keyboard">../grub/index.html#grub_keyboard</a>
			</p>
			
			<h2 id="qemu">QEMU</h2>
			
				<p>
					Libreboot comes with ROM images built for QEMU, by default:
				</p>
					<ul>
						<li><b>libreboot_qemu_q35_ich9.tar.xz</b></li>
						<li><b>libreboot_qemu_i440fx_piix4.tar.xz</b></li>
					</ul>
				<p>
					Examples of how to use libreboot in QEMU:
				</p>
					<ul>
						<li>$ <b>qemu-system-i386 -M q35 -m 512 -bios qemu_q35_ich9_keymap_mode.rom</b></li>
						<li>$ <b>qemu-system-i386 -M pc -m 512 -bios qemu_i440fx_piix4_keymap_mode.rom</b></li>
					</ul>
				<p>
					You can optionally specify the <b>-serial stdio</b> argument, so that QEMU will emulate
					a serial terminal on the standard input/output (most likely your terminal emulator or TTY).
				</p>
				<p>
					Other arguments are available for QEMU. The manual will contain more information.
				</p>

			<p>
				<a href="#pagetop">Back to top of page.</a>
			</p>
			
	</div>
	
	<div class="section">

		<h1 id="flashrom">How to install or update libreboot (if running libreboot or coreboot)</h1>

			<div class="important">
				<p>
					<b>If you are using libreboot_src or git, then make sure that you built the sources first (see <a href="../git/index.html#build">../git/index.html#build</a>).</b>
				</p>
			</div>
			
			<p>
				These instructions work for most targets, provided that they are already running libreboot or coreboot.
			</p>
			<p>
				Look at the <a href="#rom">list of ROM images</a> to see which image is compatible with your device.
			</p>
			<p>
				X60/T60 users with Lenovo BIOS should refer to <a href="#flashrom_lenovobios">#flashrom_lenovobios</a> instead.
				Similary, MacBook2,1 users running Apple EFI should refer to <a href="#flashrom_macbook21">#flashrom_macbook21</a>.
			</p>
			<p>
				<b>
					ThinkPad T60 and X60 Tablet users: be sure to read <a href="../hcl/index.html#supported_t60_list">../hcl/index.html#supported_t60_list</a>
					or <a href="../hcl/index.html#supported_t60_list">../hcl/index.html#supported_t60_list</a>.
				</b>
			</p>
			<p>
				X200/R400/T400/T500 users running Lenovo BIOS should refer to <a href="x200_external.html">x200_external.html</a>,
				<a href="r400_external.html">r400_external.html</a>,
				<a href="t400_external.html">t400_external.html</a> or
				<a href="t500_external.html">t500_external.html</a>. <b>These machines contain the hard coded
				MAC address for the onboard ethernet chipset, directly inside the SPI flash; 
				<a href="../hcl/gm45_remove_me.html#ich9gen">ich9gen</a> shows how to change it (the default
				libreboot ROM images for these machines contain a generic MAC address).</b>
			</p>
			<p>
				X200/R400/T400/T500 users should also note, that it is possible for the user to write-protect whole regions
				of the SPI flash by using a modified descriptor. Locked regions must be flashed externally;
				see <a href="x200_external.html">x200_external.html</a>, <a href="r400_external.html">r400_external.html</a>,
				<a href="t400_external.html">t400_external.html</a> or <a href="t500_external.html">t500_external.html</a>.
				<b>Libreboot unlocks all regions, by default.</b>
			</p>
			<div class="important">
				<p>
					How to update the flash chip contents:<br/>
					$ <b>sudo ./flash update <a href="#rom">yourrom.rom</a></b>
				</p>
			</div>
			<div class="important">
				<p>
					Ocassionally, coreboot changes the name of a given board. If flashrom complains about a board mismatch, but
					you are sure that you chose the correct ROM image, then run this alternative command:<br/>
					$ <b>sudo ./flash forceupdate <a href="#rom">yourrom.rom</a></b>
				</p>
			</div>

			<div class="important">

				<p>
					You should see <b>&quot;Verifying flash... VERIFIED.&quot;</b> written at the end of the flashrom output. <b>Shut down</b>
					after you see this, and then boot up again after a few seconds.
				</p>

			</div>

			<p><a href="#pagetop">Back to top of page</a></p>
			
	</div>

	<div class="section">

		<h1 id="flashrom_lenovobios">ThinkPad X60/T60: Initial installation guide (if running Lenovo BIOS firmware)</h1>

			<p><b>This is for the ThinkPad X60 and T60 while running Lenovo BIOS. If you already have coreboot or libreboot running,
			then go to <a href="#flashrom">#flashrom</a> instead!</b></p>

			<p><b>If you are flashing a Lenovo ThinkPad T60, be sure to read <a href="../hcl/index.html#supported_t60_list">../hcl/index.html#supported_t60_list</a></b></p>

			<div class="important">
				<p>
					<b>If you are using libreboot_src or git, then make sure that you built the sources first (see <a href="../git/index.html#build">../git/index.html#build</a>).</b>
				</p>
			</div>
			
			<p>
				<b>
					Warning: this guide will not instruct the user how to backup the original Lenovo BIOS firmware. These backups
					are tied to each machine, and will not work on any other.
					For that, please refer to <a href="http://www.coreboot.org/Board:lenovo/x60/Installation">http://www.coreboot.org/Board:lenovo/x60/Installation</a>.
				</b>
			</p>

			<div class="important">
				
				<p>
					The first half of the procedure is as follows:<br/>
					$ <b>sudo ./flash i945lenovo_firstflash <a href="#rom">yourrom.rom</a>.</b>
				</p>
				
			</div>
			
			<div class="important">

				<p>
					You should see within the output the following:<br/>
					<b>&quot;Updated BUC.TS=1 - 64kb address ranges at 0xFFFE0000 and 0xFFFF0000 are swapped&quot;</b>.
				</p>

				<p>
					You should also see within the output the following:<br/>
					<b>&quot;Flash chip is in an unknown state&quot;</b>, <b>&quot;FAILED&quot;</b> and <b>&quot;DO NOT SHUTDOWN OR REBOOT&quot;</b><br/>
					Seeing this means that the operation was a <b>resounding</b> success! <b>DON'T PANIC</b>.
				</p>

				<p>
					See this link for more details: 
					<a href="http://thread.gmane.org/gmane.linux.bios.flashrom/575">http://thread.gmane.org/gmane.linux.bios.flashrom/575</a>.
				</p>

				<p>
					If the above is what you see, then <b>SHUT DOWN</b>. Wait a few seconds, and then boot; libreboot is running, but there is a 2nd procedure <b>*needed*</b> (see below).
				</p>

			</div>

			<div class="important">
				<p>
					When you have booted up again, you must also do this:<br/>
					$ <b>sudo ./flash i945lenovo_secondflash <a href="#rom">yourrom.rom</a></b>
				</p>
			</div>

			<div class="important">

				<p>
					You should see within the output the following:<br/>
					<b>&quot;Updated BUC.TS=0 - 128kb address range 0xFFFE0000-0xFFFFFFFF is untranslated&quot;</b>
				</p>

				<p>
					You should also see within the output the following:<br/>
					<b>&quot;Verifying flash... VERIFIED.&quot;</b>
				</p>

			</div>

			<p><a href="#pagetop">Back to top of page.</a></p>
			
	</div>

	<div class="section">

		<h1 id="flashrom_macbook21">MacBook2,1: Initial installation guide (if running Apple EFI firmware)</h1>

			<div class="important">

				<p>
					<b>If you have a MacBook1,1, refer to <a href="../hcl/index.html#macbook11">../hcl/index.html#macbook11</a> for flashing instructions.</b>
				</p>

			</div>

			<p>
				<b>
					This is for the MacBook2,1 while running Apple EFI firmware. If you already have 
					coreboot or libreboot running, then go to <a href="#flashrom">#flashrom</a> instead!
				</b>
			</p>

			<p>
				Be sure to read the information in <a href="../hcl/index.html#macbook21">../hcl/index.html#macbook21</a>.
			</p>
			
			<p>
				<b>
					Warning: this guide will not instruct the user how to backup the original Apple EFI firmware.
					For that, please refer to <a href="http://www.coreboot.org/Board:apple/macbook21">http://www.coreboot.org/Board:apple/macbook21</a>.
				</b>
			</p>

			<div class="important">
				<p>
					<b>If you are using libreboot_src or git, then make sure that you built the sources first (see <a href="../git/index.html#build">../git/index.html#build</a>).</b>
				</p>
			</div>

			<p>
				Look at the <a href="#rom">list of ROM images</a> to see which image is compatible with your device.
			</p>

			<div class="important">
				<p>
					Use this flashing script, to install libreboot:<br/>
					$ <b>sudo ./flash i945apple_firstflash <a href="#rom">yourrom.rom</a></b>
				</p>
			</div>

			<div class="important">

				<p>
					You should also see within the output the following:<br/>
					<b>&quot;Verifying flash... VERIFIED.&quot;</b>
				</p>

				<p>
					Shut down.
				</p>

			</div>

			<p><a href="#pagetop">Back to top of page.</a></p>
			
	</div>

	<div class="section">

		<p>
			Copyright &copy; 2014, 2015 Francis Rowe &lt;info@gluglug.org.uk&gt;<br/>
			This document is released under the Creative Commons Attribution-ShareAlike 4.0 International Public License and all future versions.
			A copy of the license can be found at <a href="../license.txt">../license.txt</a>.
		</p>

		<p>
			This document is distributed in the hope that it will be useful,
			but WITHOUT ANY WARRANTY; without even the implied warranty of
			MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See <a href="../license.txt">../license.txt</a> for more information.
		</p>
		
	</div>

</body>
</html>
