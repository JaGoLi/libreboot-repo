From a4b96f105cfdefd258e743eebe920b9fc6dd3d24 Mon Sep 17 00:00:00 2001
From: Timothy Pearson <tpearson@raptorengineeringinc.com>
Date: Fri, 12 Jun 2015 13:32:52 -0500
Subject: [PATCH 056/143] mainboard/asus/kgpe-d16: Add missing IRQ routing for
 PIKE card

Change-Id: I6eba36dad71a2a2713181382484dc0e0976e1dad
Signed-off-by: Timothy Pearson <tpearson@raptorengineeringinc.com>
---
 src/mainboard/asus/kgpe-d16/dsdt.asl |   74 +++++++++++++++++++++++++---------
 1 file changed, 55 insertions(+), 19 deletions(-)

diff --git a/src/mainboard/asus/kgpe-d16/dsdt.asl b/src/mainboard/asus/kgpe-d16/dsdt.asl
index b6f10d9..bbe445f 100644
--- a/src/mainboard/asus/kgpe-d16/dsdt.asl
+++ b/src/mainboard/asus/kgpe-d16/dsdt.asl
@@ -296,13 +296,29 @@ DefinitionBlock (
 
 			Name (PR03, Package () {
 				/* PIC */
+				Package (0x04) { 0xFFFF, 0x00, LNKE, 0x00 },
+				Package (0x04) { 0xFFFF, 0x01, LNKF, 0x00 },
+				Package (0x04) { 0xFFFF, 0x02, LNKG, 0x00 },
+				Package (0x04) { 0xFFFF, 0x03, LNKH, 0x00 },
+			})
+
+			Name (AR03, Package () {
+				/* APIC */
+				Package (0x04) { 0xFFFF, 0x00, 0x00, 44 },
+				Package (0x04) { 0xFFFF, 0x01, 0x00, 45 },
+				Package (0x04) { 0xFFFF, 0x02, 0x00, 46 },
+				Package (0x04) { 0xFFFF, 0x03, 0x00, 47 },
+			})
+
+			Name (PR04, Package () {
+				/* PIC */
 				Package (0x04) { 0xFFFF, 0x00, LNKA, 0x00 },
 				Package (0x04) { 0xFFFF, 0x01, LNKB, 0x00 },
 				Package (0x04) { 0xFFFF, 0x02, LNKC, 0x00 },
 				Package (0x04) { 0xFFFF, 0x03, LNKD, 0x00 },
 			})
 
-			Name (AR03, Package () {
+			Name (AR04, Package () {
 				/* APIC */
 				Package (0x04) { 0xFFFF, 0x00, 0x00, 48 },
 				Package (0x04) { 0xFFFF, 0x01, 0x00, 49 },
@@ -310,7 +326,7 @@ DefinitionBlock (
 				Package (0x04) { 0xFFFF, 0x03, 0x00, 51 },
 			})
 
-			Name (PR04, Package () {
+			Name (PR05, Package () {
 				/* PIC */
 				Package (0x04) { 0xFFFF, 0x00, LNKH, 0x00 },
 				Package (0x04) { 0xFFFF, 0x01, LNKE, 0x00 },
@@ -318,7 +334,7 @@ DefinitionBlock (
 				Package (0x04) { 0xFFFF, 0x03, LNKG, 0x00 },
 			})
 
-			Name (AR04, Package () {
+			Name (AR05, Package () {
 				/* APIC */
 				Package (0x04) { 0xFFFF, 0x00, 0x00, 47 },
 				Package (0x04) { 0xFFFF, 0x01, 0x00, 44 },
@@ -326,7 +342,7 @@ DefinitionBlock (
 				Package (0x04) { 0xFFFF, 0x03, 0x00, 46 },
 			})
 
-			Name (PR05, Package () {
+			Name (PR06, Package () {
 				/* PIC */
 				Package (0x04) { 0xFFFF, 0x00, LNKA, 0x00 },
 				Package (0x04) { 0xFFFF, 0x01, LNKB, 0x00 },
@@ -334,7 +350,7 @@ DefinitionBlock (
 				Package (0x04) { 0xFFFF, 0x03, LNKD, 0x00 },
 			})
 
-			Name (AR05, Package () {
+			Name (AR06, Package () {
 				/* APIC */
 				Package (0x04) { 0xFFFF, 0x00, 0x00, 32 },
 				Package (0x04) { 0xFFFF, 0x01, 0x00, 33 },
@@ -342,7 +358,7 @@ DefinitionBlock (
 				Package (0x04) { 0xFFFF, 0x03, 0x00, 35 },
 			})
 
-			Name (PR06, Package () {
+			Name (PR07, Package () {
 				/* PIC */
 				Package (0x04) { 0xFFFF, 0x00, LNKE, 0x00 },
 				Package (0x04) { 0xFFFF, 0x01, LNKF, 0x00 },
@@ -350,7 +366,7 @@ DefinitionBlock (
 				Package (0x04) { 0xFFFF, 0x03, LNKH, 0x00 },
 			})
 
-			Name (AR06, Package () {
+			Name (AR07, Package () {
 				/* APIC */
 				Package (0x04) { 0xFFFF, 0x00, 0x00, 36 },
 				Package (0x04) { 0xFFFF, 0x01, 0x00, 37 },
@@ -358,7 +374,7 @@ DefinitionBlock (
 				Package (0x04) { 0xFFFF, 0x03, 0x00, 39 },
 			})
 
-			Name (PR07, Package () {
+			Name (PR08, Package () {
 				/* PIC */
 				Package (0x04) { 0xFFFF, 0x00, LNKA, 0x00 },
 				Package (0x04) { 0xFFFF, 0x01, LNKB, 0x00 },
@@ -366,7 +382,7 @@ DefinitionBlock (
 				Package (0x04) { 0xFFFF, 0x03, LNKD, 0x00 },
 			})
 
-			Name (AR07, Package () {
+			Name (AR08, Package () {
 				/* APIC */
 				Package (0x04) { 0xFFFF, 0x00, 0x00, 40 },
 				Package (0x04) { 0xFFFF, 0x01, 0x00, 41 },
@@ -617,6 +633,26 @@ DefinitionBlock (
 				}
 			}
 
+			/* 1:00.0 PIKE */
+			Device (PIKE)
+			{
+				Name (_ADR, 0x00040000)			// _ADR: Address
+				Name(_PRW, Package () {0x11, 0x04})	// Wake from S1-S4
+				Method (_PRT, 0, NotSerialized)		// _PRT: PCI Routing Table
+				{
+					If (PICM) {
+						Return (AR03)
+					} Else {
+						Return (PR03)
+					}
+				}
+				Device (SLT1)
+				{
+					Name (_ADR, 0xFFFF)			// _ADR: Address
+					Name(_PRW, Package () {0x0B, 0x04})	// Wake from S1-S4
+				}
+			}
+
 			/* 3:00.0 PCIe NIC A */
 			Device (NICA)
 			{
@@ -625,9 +661,9 @@ DefinitionBlock (
 				Method (_PRT, 0, NotSerialized)  // _PRT: PCI Routing Table
 				{
 					If (PICM) {
-						Return (AR03)
+						Return (AR04)
 					} Else {
-						Return (PR03)
+						Return (PR04)
 					}
 				}
 				Device (BDC1)
@@ -644,9 +680,9 @@ DefinitionBlock (
 				Method (_PRT, 0, NotSerialized)  // _PRT: PCI Routing Table
 				{
 					If (PICM) {
-						Return (AR04)
+						Return (AR05)
 					} Else {
-						Return (PR04)
+						Return (PR05)
 					}
 				}
 				Device (BDC2)
@@ -663,9 +699,9 @@ DefinitionBlock (
 				Method (_PRT, 0, NotSerialized)		// _PRT: PCI Routing Table
 				{
 					If (PICM) {
-						Return (AR05)
+						Return (AR06)
 					} Else {
-						Return (PR05)
+						Return (PR06)
 					}
 				}
 				Device (SLT1)
@@ -683,9 +719,9 @@ DefinitionBlock (
 				Method (_PRT, 0, NotSerialized)		// _PRT: PCI Routing Table
 				{
 					If (PICM) {
-						Return (AR06)
+						Return (AR07)
 					} Else {
-						Return (PR06)
+						Return (PR07)
 					}
 				}
 				Device (SLT1)
@@ -703,9 +739,9 @@ DefinitionBlock (
 				Method (_PRT, 0, NotSerialized)		// _PRT: PCI Routing Table
 				{
 					If (PICM) {
-						Return (AR07)
+						Return (AR08)
 					} Else {
-						Return (PR07)
+						Return (PR08)
 					}
 				}
 				Device (SLT1)
-- 
1.7.9.5

