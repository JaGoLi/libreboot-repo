From 6c534728fde6a9582915995a2742808764fe4783 Mon Sep 17 00:00:00 2001
From: Paul Kocialkowski <contact@paulk.fr>
Date: Wed, 20 Jul 2016 16:03:30 +0200
Subject: [PATCH 1/2] Avoid using git submodules for 3rdparty

This gets rid of git submodules entirely, to avoid the nuisance caused
by automatically checking them out.

Change-Id: I54de09656bd2dd9c308bd6c8dce554945aa8e535
Signed-off-by: Paul Kocialkowski <contact@paulk.fr>
---
 .gitmodules                   | 20 --------------------
 3rdparty/arm-trusted-firmware |  1 -
 3rdparty/blobs                |  1 -
 3rdparty/chromeec             |  1 -
 3rdparty/libgfxinit           |  1 -
 3rdparty/libhwbase            |  1 -
 3rdparty/vboot                |  1 -
 Makefile.inc                  | 11 -----------
 8 files changed, 37 deletions(-)
 delete mode 160000 3rdparty/arm-trusted-firmware
 delete mode 160000 3rdparty/blobs
 delete mode 160000 3rdparty/chromeec
 delete mode 160000 3rdparty/libgfxinit
 delete mode 160000 3rdparty/libhwbase
 delete mode 160000 3rdparty/vboot

diff --git a/.gitmodules b/.gitmodules
index c3270e6ae2..3a617c7dc5 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -1,23 +1,3 @@
-[submodule "3rdparty/blobs"]
-	path = 3rdparty/blobs
-	url = ../blobs.git
-	update = none
-	ignore = dirty
 [submodule "util/nvidia-cbootimage"]
 	path = util/nvidia/cbootimage
 	url = ../nvidia-cbootimage.git
-[submodule "vboot"]
-	path = 3rdparty/vboot
-	url = ../vboot.git
-[submodule "arm-trusted-firmware"]
-	path = 3rdparty/arm-trusted-firmware
-	url = ../arm-trusted-firmware.git
-[submodule "3rdparty/chromeec"]
-	path = 3rdparty/chromeec
-	url = ../chrome-ec.git
-[submodule "libhwbase"]
-	path = 3rdparty/libhwbase
-	url = ../libhwbase.git
-[submodule "libgfxinit"]
-	path = 3rdparty/libgfxinit
-	url = ../libgfxinit.git
diff --git a/3rdparty/arm-trusted-firmware b/3rdparty/arm-trusted-firmware
deleted file mode 160000
index 236c27d21f..0000000000
--- a/3rdparty/arm-trusted-firmware
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 236c27d21f52ad8f0a998e54774e3d8a4b59129d
diff --git a/3rdparty/blobs b/3rdparty/blobs
deleted file mode 160000
index 8090bdd598..0000000000
--- a/3rdparty/blobs
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 8090bdd59853599e469b7503ea473ca12e8c681b
diff --git a/3rdparty/chromeec b/3rdparty/chromeec
deleted file mode 160000
index bcffec7fdc..0000000000
--- a/3rdparty/chromeec
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit bcffec7fdc50e959cb298d094d8af472777dba75
diff --git a/3rdparty/libgfxinit b/3rdparty/libgfxinit
deleted file mode 160000
index 88a7f17b7d..0000000000
--- a/3rdparty/libgfxinit
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit 88a7f17b7d7a4f8a4d25ef6b87c71236b0862f5d
diff --git a/3rdparty/libhwbase b/3rdparty/libhwbase
deleted file mode 160000
index aab715f166..0000000000
--- a/3rdparty/libhwbase
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit aab715f166bf1b54cfbd6982e8df49248ea544d8
diff --git a/3rdparty/vboot b/3rdparty/vboot
deleted file mode 160000
index adfafba793..0000000000
--- a/3rdparty/vboot
+++ /dev/null
@@ -1 +0,0 @@
-Subproject commit adfafba793684ed92965dfbd86b3fb3463975d8c
diff --git a/Makefile.inc b/Makefile.inc
index c5ce30f2b1..919a5d4ac1 100644
--- a/Makefile.inc
+++ b/Makefile.inc
@@ -183,17 +183,6 @@ ifeq ($(CONFIG_COVERAGE),y)
 ramstage-c-ccopts += -fprofile-arcs -ftest-coverage
 endif
 
-ifneq ($(UPDATED_SUBMODULES),1)
-# try to fetch non-optional submodules if the source is under git
-forgetthis:=$(if $(GIT),$(shell git submodule update --init))
-ifeq ($(CONFIG_USE_BLOBS),y)
-# this is necessary because 3rdparty/blobs is update=none, and so is ignored
-# unless explicitly requested and enabled through --checkout
-forgetthis:=$(if $(GIT),$(shell git submodule update --init --checkout 3rdparty/blobs))
-endif
-export UPDATED_SUBMODULES:=1
-endif
-
 ramstage-c-deps:=$$(OPTION_TABLE_H)
 romstage-c-deps:=$$(OPTION_TABLE_H)
 libverstage-c-deps:=$$(OPTION_TABLE_H)
-- 
2.11.0

